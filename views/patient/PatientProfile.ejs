<%- include('../partials/header', { title: 'Patient Profile', stylesheetName: 'styles', headerTitle: 'Patient Profile' }) %>
<%-include('../partials/patientNav') %>


<div class="container-patient">
  <div class="profile-section">
    <div class="profile-info">
      <img
        src="<%= user.profile_photo || '/images/placeholder-avatar.png' %>"
        alt="Patient Avatar"
        class="avatar"
        onclick="openProfilePhotoModal()"
      />
      <div class="profile-info-detail">
        <h2><%= user.FName %> <%= user.LName %></h2>
        <p><%= age %> | <%= user.Gender %></p>
        <% if (user.Role === 6) { %>
          <a href="/update-patient" class="appointment-btn">
            Update Profile
            <span
              ><i class="fa-solid fa-edit" style="color: #ffffff"></i>
            </span>
          </a>
        <% } %>
        <a href="/addAppointment" class="appointment-btn">
          Make Appointment
          <span
            ><i class="fa-regular fa-square-plus" style="color: #ffffff"></i
          ></span>
        </a>
      </div>
    </div>

    <div id="profilePhotoModal" class="modal">
      <div class="modal-content">
        <span class="close-btn" onclick="closeProfilePhotoModal()"
          >&times;</span
        >
        <h2>Change Profile Photo</h2>
        <input type="file" id="profilePhotoInput" accept="image/*" />
        <button onclick="uploadProfilePhoto()" class="btn-upload">
          Upload
        </button>
      </div>
    </div>

    <div class="details">
      <div class="left-details">
        <div class="info-item">
          <strong>National ID:</strong> <%= user.National_ID %>
        </div>
        <p class="section-title">Contact Info</p>
        <div class="info-item">
          <i class="fas fa-phone"></i>
          <strong>Phone:</strong> <%= user.Phone %>
        </div>
        <div class="info-item">
          <i class="fas fa-envelope"></i>
          <strong>Email:</strong> <%= user.Email %>
        </div>
        <div class="info-item">
          <i class="fas fa-map-marker-alt"></i>
          <strong>Address:</strong> <%= user.Address %>
        </div>
      </div>

      <% if (insurance !== null) { %>
      <div class="right-details">
        <p class="section-title">Insurance</p>
        <div class="info-item">
          <strong>Organization:</strong> <%= insurance.Insurance_Provider %>
        </div>
        <div class="info-item">
          <strong>Coverage:</strong> <%= insurance.Insurance_Coverage %>%
        </div>
        <div class="info-item">
          <strong>Expire Date:</strong> <%= insurance.Expiry_Date %>
        </div>
      </div>
      <% } %>
    </div>
  </div>
</div>


<script>
  function openProfilePhotoModal() {
    document.getElementById("profilePhotoModal").style.display = "block";
  }

  function closeProfilePhotoModal() {
    document.getElementById("profilePhotoModal").style.display = "none";
  }
</script>
<script src="js/upload.js"></script>
<script src="js/main.js"></script>
<%- include('../partials/footer') %>
